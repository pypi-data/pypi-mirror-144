"use strict";(self.webpackChunkatoti_jupyterlab=self.webpackChunkatoti_jupyterlab||[]).push([[5004],{35004:(e,t,s)=>{s.r(t),s.d(t,{default:()=>y});var n=s(39030),l=s(56271),a=s.n(l),o=s(53521),c=s(7560),r=s(98537),i=s.n(r),u=s(2689),d=s.n(u),p=s(95479),m=s(13423);const b=e=>{const t=[];return e.forEach((e=>{const s=e.name;t.includes(s)||(e.showlegend=!0,t.push(s))})),e};function h({cube:e,data:t,metaData:s,widgetState:{mapping:n}}){if(!e||!t||!s)return[];const l={},a={},c={mapping:{},numberOfUsedAutomaticColors:0},{attributesRedirection:r}=s,u=n.size.length>0;let m=0;const h=n.horizontalSubplots.length+n.verticalSubplots.length>0;(0,p.IG)(t,s.hierarchyIndicesInCellSet,(({cell:e,cellIndex:t,columnIndex:u,tuple:d,rowIndex:p})=>{if(d){const b=(0,o._F)(d,{levelIndices:s.levelIndicesPerField,mapping:n,attributesRedirection:r}),h=[...b.color,...b.horizontalSubplots,...b.verticalSubplots],y=b.splitBy,g=(({membersPerAttribute:e,pointKey:t,traceKey:n})=>(a[n]||(a[n]=function({traceKey:e,membersPerAttribute:t}){const n=(0,o.Ym)(t.color,0),l=Object.values(a).some((e=>e.name===n)),r=(0,o.he)({accumulator:c,colorway:s.colorway,traceName:n});return{_key:e,hoverinfo:"none",legendgroup:n,mode:"markers",name:n,cellsIndices:[],showlegend:!l,text:[],textposition:"top center",type:"scatter",marker:{size:[],color:r},x:[],y:[],opacity:1}}({traceKey:n,membersPerAttribute:e})),i()(l,{[n]:{[t]:{}}}),l[n][t]))({membersPerAttribute:b,traceKey:(0,o.Lj)(h),pointKey:(0,o.Lj)(y)});if(g.cellsIndices||(g.cellsIndices=[]),null!==t&&g.cellsIndices.push({rowIndex:p,columnIndex:u,cellIndex:t}),e){const t=e.value;if(b.xValues.length>0)g.x=t;else if(b.yValues.length>0)g.y=t;else if(b.size.length>0){const e=Math.abs(t);g.size=e,e>m&&(m=e)}b.splitBy.length>0&&(g.text=(0,o.KT)(b.splitBy))}}})),Object.entries(a).forEach((([e,t])=>{const s=l[e];u||(t.marker.size=15),Object.values(s).forEach((e=>{const{cellsIndices:s,x:n,y:l,size:a,text:o}=e;t.cellsIndices.push(s),t.x.push(n),t.y.push(l),t.text.push(o),u&&t.marker.size.push(100*a/m)}))}));const y=Object.values(a);if(y.forEach((e=>{var t;e.axisIndices=d()(null===(t=e.x)||void 0===t?void 0:t.length)})),h){const e=s.subplots,t=(0,o.$)({traces:y,subplotsMetaData:e});return(0,o.Mr)(t,e),b(t),t}return b(y),y}const y=(0,o.dC)((0,o.i)((0,o.H9)((0,l.memo)((e=>{const{cube:t,data:s,metaData:r,widgetState:i,onLoaded:u}=e,d=(0,l.useMemo)((()=>(0,n.TS)(null==i?void 0:i.mapping)),[null==i?void 0:i.mapping]);(0,o.ge)({isEmpty:d,onLoaded:u});const p=(0,l.useMemo)((()=>h({cube:t,data:s,metaData:r,widgetState:i})),[t,s,r,i]),b=(0,l.useMemo)((()=>(e=>e?(0,m.IM)(o.bR,(0,o.S5)(e.subplots),(0,o.lH)(e.subplots)):{})(r)),[r]);return a().createElement(o.XN,(0,c.Z)({},e,{traces:p,layout:b,cube:t,data:s,metaData:r}))})))))}}]);