{"version":3,"sources":["webpack:///./node_modules/core-js/modules/es.string.repeat.js","webpack:///./src/components/widgets/Music/Index.vue?5141","webpack:///./src/components/widgets/Music/Index.vue","webpack:///./src/components/widgets/Music/Index.vue?d7d3"],"names":["$","repeat","target","proto","class","status","state","track","artist","title","style","time","elapsed","_withControls","prev","playPause","stop","next","volume","random","single","consume","name","components","Loading","mixins","Utils","props","refreshSeconds","type","Number","default","withControls","Boolean","data","undefined","timer","loading","musicPlugin","syncTime","timestamp","computed","this","parseBoolean","methods","refresh","request","_parseStatus","_parseTrack","stopTimer","startTimer","convertTime","parseFloat","t","h","parseInt","m","s","attr","ret","push","join","length","pluginName","Object","entries","value","indexOf","showNewTrackNotification","notify","html","image","icon","onNewPlayingTrack","event","previousTrack","file","onMusicStop","onMusicPlay","onMusicPause","Date","onSeekChange","position","onVolumeChange","onRepeatChange","onRandomChange","onConsumeChange","onSingleChange","setInterval","timerFunc","clearInterval","getTime","_run","action","args","mounted","toFixed","subscribe","render","__scopeId"],"mappings":"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","file":"static/js/chunk-da0a28d2.e49720f2.js","sourcesContent":["var $ = require('../internals/export');\nvar repeat = require('../internals/string-repeat');\n\n// `String.prototype.repeat` method\n// https://tc39.es/ecma262/#sec-string.prototype.repeat\n$({ target: 'String', proto: true }, {\n  repeat: repeat\n});\n","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./Index.vue?vue&type=style&index=0&id=68a15751&lang=scss&scoped=true\"","<template>\n  <Loading v-if=\"loading\" />\n  <div class=\"music\" v-else>\n    <div class=\"track\">\n      <div class=\"unknown\" v-if=\"!status\">[Unknown state]</div>\n      <div class=\"no-track\" v-if=\"status && status.state === 'stop'\">No media is being played</div>\n      <div class=\"artist\" v-if=\"status && status.state !== 'stop' && track && track.artist\" v-text=\"track.artist\"></div>\n      <div class=\"title\" v-if=\"status && status.state !== 'stop' && track && track.title\" v-text=\"track.title\"></div>\n    </div>\n\n    <div class=\"time\"  v-if=\"status && status.state === 'play'\">\n      <div class=\"row\">\n        <div class=\"progress-bar\">\n          <div class=\"elapsed\" :style=\"{width: track.time ? 100*(status.elapsed/track.time) + '%' : '100%'}\"></div>\n          <div class=\"total\"></div>\n        </div>\n      </div>\n\n      <div class=\"row\">\n        <div class=\"col-6 time-elapsed\" v-text=\"convertTime(status.elapsed)\"></div>\n        <div class=\"col-6 time-total\" v-if=\"track.time\" v-text=\"convertTime(track.time)\"></div>\n      </div>\n    </div>\n\n    <div class=\"controls\" v-if=\"_withControls && status\">\n      <button @click=\"prev\">\n        <i class=\"fa fa-step-backward\" />\n      </button>\n      <button class=\"play-pause\" @click=\"playPause\">\n        <i class=\"fa fa-pause\" v-if=\"status.state === 'play'\" />\n        <i class=\"fa fa-play\" v-else />\n      </button>\n      <button @click=\"stop\" v-if=\"status.state !== 'stop'\">\n        <i class=\"fa fa-stop\" />\n      </button>\n      <button @click=\"next\">\n        <i class=\"fa fa-step-forward\" />\n      </button>\n    </div>\n\n    <div class=\"playback-status\" v-if=\"status\">\n      <div class=\"status-property col-4\">\n        <i class=\"fa fa-volume-up\"></i>&nbsp; <span v-text=\"status.volume + '%'\"></span>\n      </div>\n\n      <div class=\"status-property col-2\">\n        <i class=\"fas fa-random\" :class=\"{active: status.random}\"></i>\n      </div>\n      <div class=\"status-property col-2\">\n        <i class=\"fas fa-redo\" :class=\"{active: status.repeat}\"></i>\n      </div>\n      <div class=\"status-property col-2\">\n        <i class=\"fa fa-bullseye\" :class=\"{active: status.single}\"></i>\n      </div>\n      <div class=\"status-property col-2\">\n        <i class=\"fa fa-utensils\" :class=\"{active: status.consume}\"></i>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport Utils from \"@/Utils\";\nimport Loading from \"@/components/Loading\";\n\nexport default {\n  name: \"Music\",\n  components: {Loading},\n  mixins: [Utils],\n  props: {\n    // Refresh interval in seconds.\n    refreshSeconds: {\n      type: Number,\n      default: 60,\n    },\n\n    // Set to true if you also want to include music controls in the widget.\n    withControls: {\n      type: Boolean,\n      default: true,\n    }\n  },\n\n  data() {\n    return {\n      track: undefined,\n      status: undefined,\n      timer: undefined,\n      loading: false,\n      musicPlugin: 'music.mpd',\n\n      syncTime: {\n        timestamp: null,\n        elapsed: null,\n      },\n    }\n  },\n\n  computed: {\n    _withControls() {\n      return this.parseBoolean(this.withControls)\n    },\n  },\n\n  methods: {\n    async refresh() {\n      this.loading = true\n\n      try {\n        let status = await this.request(`${this.musicPlugin}.status`)\n        let track = await this.request(`${this.musicPlugin}.current_track`)\n\n        this._parseStatus(status)\n        this._parseTrack(track)\n\n        if (status.state === 'play' && !this.timer)\n          this.startTimer()\n        else if (status.state !== 'play' && this.timer)\n          this.stopTimer()\n      } finally {\n        this.loading = false\n      }\n    },\n\n    convertTime(time) {\n      time = parseFloat(time)   // Normalize strings\n      const t = {}\n      t.h = parseInt(time/3600)\n      t.m = parseInt(time/60 - t.h*60)\n      t.s = parseInt(time - (t.h*3600 + t.m*60))\n\n      for (const attr of ['m','s']) {\n        t[attr] = '' + t[attr]\n      }\n\n      for (const attr of ['m','s']) {\n        if (parseInt(t[attr]) < 10) {\n          t[attr] = '0' + t[attr]\n        }\n      }\n\n      const ret = []\n      if (parseInt(t.h)) {\n        ret.push(t.h)\n      }\n\n      ret.push(t.m, t.s)\n      return ret.join(':')\n    },\n\n    async _parseStatus(status) {\n      if (!status || status.length === 0)\n        status = await this.request(`${this.musicPlugin}.status`)\n      if (status?.pluginName)\n        this.musicPlugin = status.pluginName\n      if (!this.status)\n        this.status = {}\n\n      for (const [attr, value] of Object.entries(status)) {\n        if (['consume','random','repeat','single','bitrate'].indexOf(attr) >= 0) {\n          this.status[attr] = !!parseInt(value)\n        } else if (['nextsong','nextsongid','playlist','playlistlength',\n          'volume','xfade','song','songid'].indexOf(attr) >= 0) {\n          this.status[attr] = parseInt(value)\n        } else if (['elapsed'].indexOf(attr) >= 0) {\n          this.status[attr] = parseFloat(value)\n        } else {\n          this.status[attr] = value\n        }\n      }\n    },\n\n    async _parseTrack(track) {\n      if (!track || track.length === 0) {\n        track = await this.request(`${this.musicPlugin}.current_track`)\n      }\n\n      if (!this.track)\n        this.track = {}\n\n      for (const [attr, value] of Object.entries(track)) {\n        if (['id','pos','time','track','disc'].indexOf(attr) >= 0) {\n          this.track[attr] = parseInt(value)\n        } else {\n          this.track[attr] = value\n        }\n      }\n    },\n\n    showNewTrackNotification() {\n      this.notify({\n        html: '<b>' + (this.track.artist || '[No Artist]') + '</b><br>' +\n            (this.track.title || '[No Title]'),\n        image: {\n          icon: 'play',\n        }\n      })\n    },\n\n    async onNewPlayingTrack(event) {\n      let previousTrack = undefined\n\n      if (this.track) {\n        previousTrack = {\n          file: this.track.file,\n          artist: this.track.artist,\n          title: this.track.title,\n        }\n      }\n\n      this.status.state = 'play'\n      this.status.elapsed = 0\n      this.track = {}\n      this._parseTrack(event.track)\n\n      let status = event.status ? event.status : await this.request(`${this.musicPlugin}.status`)\n      this._parseStatus(status)\n      this.startTimer()\n\n      if (!previousTrack || (this.track.file !== previousTrack.file\n          || this.track.artist !== previousTrack.artist\n          || this.track.title !== previousTrack.title)) {\n        this.showNewTrackNotification()\n      }\n    },\n\n    onMusicStop(event) {\n      this.status.state = 'stop'\n      this.status.elapsed = 0\n      this._parseStatus(event.status)\n      this._parseTrack(event.track)\n      this.stopTimer()\n    },\n\n    onMusicPlay(event) {\n      this.status.state = 'play'\n      this._parseStatus(event.status)\n      this._parseTrack(event.track)\n      this.startTimer()\n    },\n\n    onMusicPause(event) {\n      this.status.state = 'pause'\n      this._parseStatus(event.status)\n      this._parseTrack(event.track)\n\n      this.syncTime.timestamp = new Date()\n      this.syncTime.elapsed = this.status.elapsed\n    },\n\n    onSeekChange(event) {\n      if (event.position != null)\n        this.status.elapsed = parseFloat(event.position)\n      if (event.status)\n        this._parseStatus(event.status)\n      if (event.track)\n        this._parseTrack(event.track)\n\n      this.syncTime.timestamp = new Date()\n      this.syncTime.elapsed = this.status.elapsed\n    },\n\n    onVolumeChange(event) {\n      if (event.volume != null)\n        this.status.volume = parseFloat(event.volume)\n      if (event.status)\n        this._parseStatus(event.status)\n      if (event.track)\n        this._parseTrack(event.track)\n    },\n\n    onRepeatChange(event) {\n      this.status.repeat = event.state\n    },\n\n    onRandomChange(event) {\n      this.status.random = event.state\n    },\n\n    onConsumeChange(event) {\n      this.status.consume = event.state\n    },\n\n    onSingleChange(event) {\n      this.status.single = event.state\n    },\n\n    startTimer() {\n      if (this.timer != null) {\n        this.stopTimer()\n      }\n\n      this.syncTime.timestamp = new Date()\n      this.syncTime.elapsed = this.status.elapsed\n      this.timer = setInterval(this.timerFunc, 1000)\n    },\n\n    stopTimer() {\n      if (this.timer == null) {\n        clearInterval(this.timer)\n        this.timer = null\n      }\n    },\n\n    timerFunc() {\n      if (this.status.state !== 'play' || this.status.elapsed == null) {\n        return\n      }\n\n      this.status.elapsed = this.syncTime.elapsed +\n          ((new Date()).getTime()/1000) - (this.syncTime.timestamp.getTime()/1000)\n    },\n\n    async _run(action, args) {\n      args = args || {}\n      await this.request(`music.mpd.${action}`, args)\n      await this.refresh()\n    },\n\n    async playPause() {\n      return await this._run('pause')\n    },\n\n    async stop() {\n      return await this._run('stop')\n    },\n\n    async prev() {\n      return await this._run('previous')\n    },\n\n    async next() {\n      return await this._run('next')\n    },\n  },\n\n  mounted() {\n    this.refresh()\n    if (this.refreshSeconds) {\n      setInterval(this.refresh, parseInt((this.refreshSeconds*1000).toFixed(0)))\n    }\n\n    this.subscribe(this.onNewPlayingTrack, 'widget-music-on-new-track', 'platypush.message.event.music.NewPlayingTrackEvent')\n    this.subscribe(this.onMusicStop, 'widget-music-on-music-stop', 'platypush.message.event.music.MusicStopEvent')\n    this.subscribe(this.onMusicPlay, 'widget-music-on-music-play', 'platypush.message.event.music.MusicPlayEvent')\n    this.subscribe(this.onMusicPause, 'widget-music-on-music-pause', 'platypush.message.event.music.MusicPauseEvent')\n    this.subscribe(this.onSeekChange, 'widget-music-on-music-seek', 'platypush.message.event.music.SeekChangeEvent')\n    this.subscribe(this.onVolumeChange, 'widget-music-on-volume-change', 'platypush.message.event.music.VolumeChangeEvent')\n    this.subscribe(this.onRepeatChange, 'widget-music-on-repeat-change', 'platypush.message.event.music.PlaybackRepeatModeChangeEvent')\n    this.subscribe(this.onRandomChange, 'widget-music-on-random-change', 'platypush.message.event.music.PlaybackRandomModeChangeEvent')\n    this.subscribe(this.onConsumeChange, 'widget-music-on-consume-change', 'platypush.message.event.music.PlaybackConsumeModeChangeEvent')\n    this.subscribe(this.onSingleChange, 'widget-music-on-single-change', 'platypush.message.event.music.PlaybackSingleModeChangeEvent')\n  },\n}\n</script>\n\n<style lang=\"scss\" scoped>\n$progress-bar-bg: #ddd;\n$playback-status-color: #757f70;\n\n.music {\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  position: relative;\n\n  .track {\n    text-align: center;\n\n    .unknown,\n    .no-track {\n      font-size: 2em;\n    }\n\n    .artist {\n      font-size: 1.9em;\n      font-weight: bold;\n      margin-bottom: .25em;\n    }\n\n    .title {\n      font-size: 1.8em;\n      font-weight: normal;\n    }\n  }\n\n  .time {\n    width: 100%;\n    margin-top: 1em;\n    font-size: 1.2em;\n\n    .row {\n      padding: 0 .5em;\n    }\n\n    .time-total {\n      text-align: right;\n    }\n\n    .progress-bar {\n      width: 100%;\n      height: 1em;\n      position: relative;\n      margin-bottom: .75em;\n\n      .total {\n        position: absolute;\n        width: 100%;\n        height: 100%;\n        top: 0;\n        background: $progress-bar-bg;\n        border-radius: 0.5em;\n      }\n\n      .elapsed {\n        position: absolute;\n        width: 100%;\n        height: 100%;\n        top: 0;\n        background: $selected-bg;\n        border-radius: 0.5em;\n        z-index: 1;\n      }\n    }\n  }\n\n  .playback-status {\n    position: absolute;\n    bottom: 0;\n    border-top: $default-border-2;\n    color: $playback-status-color;\n    width: 100%;\n    height: 2em;\n\n    .status-property {\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      height: 100%;\n    }\n\n    .active {\n      color: $default-hover-fg;\n    }\n  }\n\n  .controls {\n    margin-top: .5em;\n    font-size: 1.2em;\n\n    button {\n      background: none;\n      border: none;\n\n      &:hover {\n        color: $default-hover-fg;\n      }\n\n      &.play-pause {\n        color: $selected-fg;\n        font-size: 1.5em;\n      }\n    }\n  }\n}\n</style>\n","import { render } from \"./Index.vue?vue&type=template&id=68a15751&scoped=true\"\nimport script from \"./Index.vue?vue&type=script&lang=js\"\nexport * from \"./Index.vue?vue&type=script&lang=js\"\n\nimport \"./Index.vue?vue&type=style&index=0&id=68a15751&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-68a15751\"\n\nexport default script"],"sourceRoot":""}